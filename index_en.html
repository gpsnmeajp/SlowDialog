<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SlowDialog</title>
  <meta name="description" content="Game Boy-style AI chat app â€” giving humans back control of the conversation">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <!-- ===== Toolbar ===== -->
  <header id="toolbar">
    <h1 id="app-title">SlowDialog</h1>
    <div id="toolbar-buttons">
      <button id="btn-settings" title="Settings">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
          stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="3" />
          <path
            d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 01-2.83 2.83l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z" />
        </svg>
      </button>
      <button id="btn-export" title="Export History">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
          <path d="M10 3v10M10 13l-3-3M10 13l3-3M4 15h12" stroke="currentColor" stroke-width="2"
            stroke-linecap="square" />
        </svg>
      </button>
      <button id="btn-import" title="Import History">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
          <path d="M10 17V7M10 7l-3 3M10 7l3 3M4 5h12" stroke="currentColor" stroke-width="2"
            stroke-linecap="square" />
        </svg>
      </button>
      <button id="btn-clear" title="Clear Chat">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
          <path d="M5 5h10M8 5V4h4v1M6 5v11h8V5" stroke="currentColor" stroke-width="2" stroke-linecap="square" />
        </svg>
      </button>
    </div>
  </header>

  <!-- ===== Chat Area ===== -->
  <main id="chat-area">
    <div id="chat-messages"></div>
  </main>

  <!-- ===== Quick Responses ===== -->
  <div id="quick-responses"></div>

  <!-- ===== Input Area ===== -->
  <footer id="input-area">
    <textarea id="user-input" placeholder="Type a message..." rows="1"></textarea>
    <button id="btn-send" title="Send">
      <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
        <path d="M4 11l14-7-7 14v-7H4z" fill="currentColor" />
      </svg>
    </button>
  </footer>

  <!-- ===== Settings Dialog ===== -->
  <div id="settings-overlay" class="hidden">
    <div id="settings-dialog">
      <h2>Settings</h2>
      <p class="settings-hint">Save button is at the bottom<br>All your data is stored locally in your browser.</p>
      <form id="settings-form">
        <label for="setting-baseurl">Base URL</label>
        <input type="url" id="setting-baseurl" placeholder="https://api.openai.com/v1">

        <label for="setting-apikey">API Key</label>
        <input type="password" id="setting-apikey" placeholder="sk-...">

        <label for="setting-model">Model Name</label>
        <input type="text" id="setting-model" placeholder="gpt-4o-mini">

        <label for="setting-systemprompt">System Prompt</label>
        <textarea id="setting-systemprompt" rows="3" placeholder="You are a helpful assistant."></textarea>

        <label for="setting-font">Font</label>
        <select id="setting-font">
          <option value="k8x12S">k8x12S</option>
          <option value="k8x12">k8x12</option>
          <option value="k8x12L">k8x12L</option>
          <option value="MisakiGothic">Misaki Gothic</option>
          <option value="NotoSansJP" selected>Noto Sans JP</option>
        </select>

        <label for="setting-theme">Color Theme</label>
        <select id="setting-theme">
          <option value="gb">GB Classic</option>
          <option value="gb-inv">GB Classic (Inverted)</option>
          <option value="red">Red</option>
          <option value="red-inv">Red (Inverted)</option>
          <option value="amber">Amber</option>
          <option value="amber-inv">Amber (Inverted)</option>
          <option value="green">Green</option>
          <option value="green-inv">Green (Inverted)</option>
          <option value="blue">Blue</option>
          <option value="blue-inv">Blue (Inverted)</option>
          <option value="mono">Mono</option>
          <option value="mono-inv">Mono (Inverted)</option>
          <option value="dos">DOS Console</option>
          <option value="msx">MSX Console</option>
        </select>

        <label class="checkbox-row">
          <input type="checkbox" id="setting-autoadvance" checked>
          Auto Advance
        </label>

        <label class="checkbox-row">
          <input type="checkbox" id="setting-show-pause-button" checked>
          Pause Button (Auto Advance)
        </label>

        <label class="checkbox-row">
          <input type="checkbox" id="setting-sound" checked>
          Sound Effects
        </label>

        <label class="checkbox-row">
          <input type="checkbox" id="setting-show-borders" checked>
          Borders
        </label>

        <label class="checkbox-row">
          <input type="checkbox" id="setting-send-timestamp">
          Send Time to AI
        </label>

        <label class="checkbox-row">
          <input type="checkbox" id="setting-scanline">
          Scanline Effect
        </label>
        <div class="slider-row">
          <input type="range" id="setting-scanline-strength" min="1" max="50" value="2">
          <span id="scanline-strength-value" class="slider-value">2%</span>
        </div>

        <label for="setting-chardelay">Delay per Character (ms)</label>
        <input type="number" id="setting-chardelay" min="0" max="1000" value="150">

        <label for="setting-mindelay">Minimum Delay (sec)</label>
        <input type="number" id="setting-mindelay" min="0" max="30" step="0.1" value="2">

        <label for="setting-contextsize">Context Size (messages)</label>
        <input type="number" id="setting-contextsize" min="2" value="1000">

        <label for="setting-quickresponses">Quick Responses (one per line)</label>
        <textarea id="setting-quickresponses" rows="3" placeholder="I see&#10;Hold on&#10;That's not right"></textarea>

        <a href="https://github.com/gpsnmeajp/SlowDialog" target="_blank" rel="noopener noreferrer" id="btn-github-link">GitHub Repository</a>

        <div id="settings-buttons">
          <button type="submit" id="btn-save-settings">Save</button>
          <button type="button" id="btn-cancel-settings">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ===== Intro Dialog ===== -->
  <div id="intro-overlay" class="hidden">
    <div id="intro-dialog">
      <h2>SlowDialog</h2>
      <p>Welcome.</p>
      <p>SlowDialog is a chat app designed for slow, thoughtful conversations with AI.</p>
      <p>AI responses arrive gradually, as if typed by a human. This creates space for reflection and makes conversations feel more natural.</p>
      <p>You can interrupt anytime. Even while the AI is responding, you can send a message and it will respond to you.</p>
      <p>All your data is stored locally in your browser.</p>
      <button id="btn-intro-next">Get Started</button>
    </div>
  </div>

  <!-- ===== Import Dialog ===== -->
  <div id="import-overlay" class="hidden">
    <div id="import-dialog">
      <h2>Import History</h2>
      <div id="import-content">
        <label for="import-file" class="import-file-label">Choose File</label>
        <input type="file" id="import-file" accept=".json">
        <div class="import-divider"><span>or</span></div>
        <label for="import-json">Paste JSON</label>
        <textarea id="import-json" rows="6" placeholder='[{"role":"user","content":"..."}]'></textarea>
        <div id="import-error" class="hidden"></div>
        <div id="import-buttons">
          <button type="button" id="btn-import-exec">Import</button>
          <button type="button" id="btn-import-cancel">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== Clear Confirm Dialog ===== -->
  <div id="confirm-overlay" class="hidden">
    <div id="confirm-dialog">
      <p>Are you sure you want to clear?</p>
      <p class="confirm-sub">Please export first if needed.</p>
      <div id="confirm-buttons">
        <button id="btn-confirm-ok">Clear</button>
        <button id="btn-confirm-cancel">Cancel</button>
      </div>
    </div>
  </div>

  <!-- ===== Retry Bar ===== -->
  <div id="retry-bar" class="hidden">
    <span>Communication failed</span>
    <button id="btn-retry">Retry</button>
  </div>

  <!-- ===== Bubble Action Dialog (User) ===== -->
  <div id="bubble-action-overlay" class="hidden">
    <div id="bubble-action-dialog">
      <p id="bubble-action-text"></p>
      <div id="bubble-action-buttons">
        <button id="btn-bubble-resend"></button>
        <button id="btn-bubble-edit"></button>
        <button id="btn-bubble-action-cancel"></button>
      </div>
    </div>
  </div>

  <!-- ===== Bubble Edit Dialog ===== -->
  <div id="bubble-edit-overlay" class="hidden">
    <div id="bubble-edit-dialog">
      <h2 id="bubble-edit-title"></h2>
      <textarea id="bubble-edit-text" rows="4"></textarea>
      <div id="bubble-edit-buttons">
        <button id="btn-bubble-edit-send"></button>
        <button id="btn-bubble-edit-cancel"></button>
      </div>
    </div>
  </div>

  <!-- ===== Bubble Delete Dialog (Assistant) ===== -->
  <div id="bubble-delete-overlay" class="hidden">
    <div id="bubble-delete-dialog">
      <p id="bubble-delete-text"></p>
      <div id="bubble-delete-buttons">
        <button id="btn-bubble-delete-ok"></button>
        <button id="btn-bubble-delete-cancel"></button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>

</html>
